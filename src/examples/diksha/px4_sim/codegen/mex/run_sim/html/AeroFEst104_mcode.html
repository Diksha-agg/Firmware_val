<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="57,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T4U3">Fa</span>,<span class="var type1" id="S3T4U4">Fa_w</span>,<span class="var type1" id="S4T3U5">alpha</span>,<span class="var type1" id="S5T3U6">beta</span> ] = AeroFEst( <span class="var type1" id="S6T6U9">eul</span>,<span class="var type1" id="S7T4U10">x_dot</span>,<span class="var type1" id="S8T4U11">omega</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="57,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%UNTITLED Summary of this function goes here</span></span></span>
<span class="srcline"><span class="lineno"><a href="57,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%   Detailed explanation goes here</span></span></span>
<span class="srcline"><span class="lineno"><a href="57,4" id="srcline4"> 4</a></span><span class="line">coder.inline(<span class="string">'never'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="57,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T3:U8"><span class="var type1" id="S10T3U20">c_root</span>=<span class="mxinfo " id="T3:U10">0.39</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T3:U11"><span class="var type1" id="S11T3U24">c_tip</span>=<span class="mxinfo " id="T3:U13">0.176</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T3:U14"><span class="var type1" id="S12T3U28">t</span>= <span class="mxinfo " id="T3:U16"><span class="var type1" id="S11T3U30">c_tip</span>/<span class="var type1" id="S10T3U31">c_root</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo " id="T3:U19"><span class="var type1" id="S13T3U34">BQ_c</span> = <span class="mxinfo " id="T3:U21"><span class="mxinfo " id="T3:U22"><span class="var type1" id="S10T3U37">c_root</span>*(<span class="mxinfo " id="T3:U24"><span class="mxinfo " id="T3:U25">2</span>/<span class="mxinfo " id="T3:U26">3</span></span>)</span>*(<span class="mxinfo " id="T3:U27">(<span class="mxinfo " id="T3:U28">1+<span class="var type1" id="S12T3U48">t</span>+<span class="var type1" id="S12T3U50">t</span>^2</span>)/(<span class="mxinfo " id="T3:U31">1+<span class="var type1" id="S12T3U55">t</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T3:U33"><span class="var type1" id="S14T3U58">BQ_b</span>=<span class="mxinfo " id="T3:U35"><span class="mxinfo " id="T3:U36">2.29</span>/<span class="mxinfo " id="T3:U37">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T3:U38"><span class="var type1" id="S15T3U64">BQ_S</span>=<span class="mxinfo " id="T3:U40"><span class="mxinfo " id="T3:U41">0.754</span>/<span class="mxinfo " id="T3:U42">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,11" id="srcline11">11</a></span><span class="line"><span class="mxinfo " id="T3:U43"><span class="var type1" id="S16T3U70">BQ_CD_0</span>=<span class="mxinfo " id="T3:U45">0.009</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo " id="T3:U46"><span class="var type1" id="S17T3U74">BQ_CL0</span>=<span class="mxinfo " id="T3:U48">0.4918</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T3:U49"><span class="var type1" id="S18T3U78">BQ_CL_alpha</span>=<span class="mxinfo " id="T3:U51">4.695</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T3:U52"><span class="var type1" id="S19T3U82">BQ_CLq</span>=<span class="mxinfo " id="T3:U54">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T3:U55"><span class="var type1" id="S20T3U86">BQ_CY_beta</span>=<span class="mxinfo " id="T3:U57">-<span class="mxinfo " id="T3:U58">0.951</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo " id="T3:U59"><span class="var type1" id="S21T3U91">BQ_CY_p</span>=<span class="mxinfo " id="T3:U61">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T3:U62"><span class="var type1" id="S22T3U95">BQ_CY_r</span>=<span class="mxinfo " id="T3:U64">0.008</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,18" id="srcline18">18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="57,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T3:U65"><span class="var type1" id="S23T3U99">BQ_k</span>=<span class="mxinfo " id="T3:U67"><span class="mxinfo " id="T3:U68">1</span>/(<span class="mxinfo " id="T3:U69">pi*6.9*0.8</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo " id="T3:U70"><span class="var type1" id="S25T3U111">BQ_M</span>=<span class="mxinfo " id="T3:U72">50</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T3:U73"><span class="var type1" id="S26T3U115">BQ_alpha0</span>=<span class="mxinfo " id="T3:U75"><span class="mxinfo " id="T3:U76">20</span>*(<span class="mxinfo " id="T3:U77"><span class="mxinfo " id="T3:U78">pi</span>/<span class="mxinfo " id="T3:U79">180</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,22" id="srcline22">22</a></span><span class="line"><span class="mxinfo " id="T4:U80"><span class="var type1" id="S2T4U125">Fa</span>=<span class="mxinfo " id="T4:U82">[<span class="mxinfo " id="T3:U83">0</span>;<span class="mxinfo " id="T3:U84">0</span>;<span class="mxinfo " id="T3:U85">0</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo " id="T4:U86"><span class="var type1" id="S3T4U135">Fa_w</span>=<span class="mxinfo " id="T4:U88">[<span class="mxinfo " id="T3:U89">0</span>;<span class="mxinfo " id="T3:U90">0</span>;<span class="mxinfo " id="T3:U91">0</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,24" id="srcline24">24</a></span><span class="line"><span class="mxinfo " id="T3:U92"><span class="var type1" id="S4T3U145">alpha</span>=<span class="mxinfo " id="T3:U94">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T3:U95"><span class="var type1" id="S5T3U149">beta</span>=<span class="mxinfo " id="T3:U97">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,26" id="srcline26">26</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="57,27" id="srcline27">27</a></span><span class="line"><span class="mxinfo " id="T3:U98"><span class="var type1" id="S27T3U153">p</span>=<span class="mxinfo " id="T3:U100"><span class="var type1" id="S8T4U155">omega</span>(<span class="mxinfo " id="T3:U102">1</span>,<span class="mxinfo " id="T3:U103">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,28" id="srcline28">28</a></span><span class="line"><span class="mxinfo " id="T3:U104"><span class="var type1" id="S28T3U160">q</span>=<span class="mxinfo " id="T3:U106"><span class="var type1" id="S8T4U162">omega</span>(<span class="mxinfo " id="T14:U108">2</span>,<span class="mxinfo " id="T14:U109">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,29" id="srcline29">29</a></span><span class="line"><span class="mxinfo " id="T3:U110"><span class="var type1" id="S29T3U167">r</span>=<span class="mxinfo " id="T3:U112"><span class="var type1" id="S8T4U169">omega</span>(<span class="mxinfo " id="T3:U114">3</span>,<span class="mxinfo " id="T3:U115">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,30" id="srcline30">30</a></span><span class="line"><span class="mxinfo " id="T3:U116"><span class="var type1" id="S30T3U174">rho</span>=<span class="mxinfo " id="T3:U118">1.225</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,31" id="srcline31">31</a></span><span class="line"><span class="comment">% Eul=quat2eul((quat/norm(quat))');</span></span></span>
<span class="srcline"><span class="lineno"><a href="57,32" id="srcline32">32</a></span><span class="line"><span class="comment">% psi=Eul(1,1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="57,33" id="srcline33">33</a></span><span class="line"><span class="comment">% theta=Eul(1,2);</span></span></span>
<span class="srcline"><span class="lineno"><a href="57,34" id="srcline34">34</a></span><span class="line"><span class="comment">% phi=Eul(1,3);</span></span></span>
<span class="srcline"><span class="lineno"><a href="57,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo " id="T26:U119"><span class="var type1" id="S31T26U178">R</span>=<span class="mxinfo " id="T26:U121"><span class="fcn" id="F77N6:B180">eul2rotm</span>(<span class="var type1" id="S6T6U181">eul</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo " id="T4:U123"><span class="var type1" id="S33T4U184">xb_dot</span>=<span class="mxinfo " id="T4:U125"><span class="mxinfo " id="T26:U126"><span class="var type1" id="S31T26U187">R</span>'</span>*<span class="var type1" id="S7T4U188">x_dot</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,37" id="srcline37">37</a></span><span class="line"><span class="mxinfo " id="T3:U129"><span class="var type1" id="S34T3U191">V</span>=<span class="mxinfo " id="T3:U131">norm(<span class="var type1" id="S7T4U194">x_dot</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,38" id="srcline38">38</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="57,39" id="srcline39">39</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo " id="T11:U133"><span class="var type1" id="S34T3U199">V</span>==<span class="mxinfo " id="T3:U135">0</span></span>) <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,40" id="srcline40">40</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="57,41" id="srcline41">41</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="57,42" id="srcline42">42</a></span><span class="line"><span class="mxinfo " id="T26:U136"><span class="var type1" id="S36T26U204">Rq2w</span> = <span class="mxinfo " id="T26:U138">[</span></span>
<span class="srcline"><span class="lineno"><a href="57,43" id="srcline43">43</a></span><span class="line">    0 0 1;</span></span>
<span class="srcline"><span class="lineno"><a href="57,44" id="srcline44">44</a></span><span class="line">    0 1 0;</span></span>
<span class="srcline"><span class="lineno"><a href="57,45" id="srcline45">45</a></span><span class="line">    -1 0 0]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,46" id="srcline46">46</a></span><span class="line"><span class="mxinfo " id="T4:U139"><span class="var type1" id="S37T4U221">xw_dot</span> = <span class="mxinfo " id="T4:U141"><span class="var type1" id="S36T26U223">Rq2w</span>*<span class="var type1" id="S33T4U224">xb_dot</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,47" id="srcline47">47</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="57,48" id="srcline48">48</a></span><span class="line"><span class="comment">% alpha=atan2(-xw_dot(3),xw_dot(1));</span></span></span>
<span class="srcline"><span class="lineno"><a href="57,49" id="srcline49">49</a></span><span class="line"><span class="comment">% beta=atan2(xw_dot(2),xw_dot(1));</span></span></span>
<span class="srcline"><span class="lineno"><a href="57,50" id="srcline50">50</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="57,51" id="srcline51">51</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo " id="T11:U144"><span class="mxinfo " id="T3:U145"><span class="var type1" id="S37T4U230">xw_dot</span>(<span class="mxinfo " id="T14:U147">1</span>)</span>~=<span class="mxinfo " id="T3:U148">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="57,52" id="srcline52">52</a></span><span class="line">    <span class="mxinfo " id="T3:U149"><span class="var type1" id="S4T3U235">alpha</span>=<span class="mxinfo " id="T3:U151">atan2(<span class="mxinfo " id="T3:U152">-<span class="mxinfo " id="T3:U153"><span class="var type1" id="S37T4U240">xw_dot</span>(<span class="mxinfo " id="T14:U155">3</span>)</span></span>,<span class="mxinfo " id="T3:U156"><span class="var type1" id="S37T4U243">xw_dot</span>(<span class="mxinfo " id="T14:U158">1</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,53" id="srcline53">53</a></span><span class="line">    <span class="mxinfo " id="T3:U159"><span class="var type1" id="S5T3U247">beta</span>=<span class="mxinfo " id="T3:U161">atan2(<span class="mxinfo " id="T3:U162"><span class="var type1" id="S37T4U251">xw_dot</span>(<span class="mxinfo " id="T14:U164">2</span>)</span>,<span class="mxinfo " id="T3:U165"><span class="var type1" id="S37T4U254">xw_dot</span>(<span class="mxinfo " id="T14:U167">1</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,54" id="srcline54">54</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="57,55" id="srcline55">55</a></span><span class="line">    <span class="mxinfo " id="T3:U168"><span class="var type1" id="S4T3U259">alpha</span>=<span class="mxinfo " id="T3:U170">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,56" id="srcline56">56</a></span><span class="line">    <span class="mxinfo " id="T3:U171"><span class="var type1" id="S5T3U263">beta</span>=<span class="mxinfo " id="T3:U173">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,57" id="srcline57">57</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="57,58" id="srcline58">58</a></span><span class="line"><span class="comment">% alpha=atan2(xb_dot(1),xb_dot(3));</span></span></span>
<span class="srcline"><span class="lineno"><a href="57,59" id="srcline59">59</a></span><span class="line"><span class="comment">% beta=atan2(xb_dot(2),xb_dot(3));</span></span></span>
<span class="srcline"><span class="lineno"><a href="57,60" id="srcline60">60</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="57,61" id="srcline61">61</a></span><span class="line"><span class="comment">% alpha = abs(alpha);</span></span></span>
<span class="srcline"><span class="lineno"><a href="57,62" id="srcline62">62</a></span><span class="line"><span class="comment">% beta = abs(beta);</span></span></span>
<span class="srcline"><span class="lineno"><a href="57,63" id="srcline63">63</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="57,64" id="srcline64">64</a></span><span class="line"><span class="mxinfo " id="T26:U174"><span class="var type1" id="S39T26U267">A</span>=<span class="mxinfo " id="T26:U176">[ <span class="mxinfo " id="T6:U177"><span class="mxinfo " id="T3:U178"><span class="mxinfo " id="T3:U179">sin(<span class="var type1" id="S4T3U273">alpha</span>)</span>*<span class="mxinfo " id="T3:U181">cos(<span class="var type1" id="S5T3U276">beta</span>)</span></span>    <span class="mxinfo " id="T3:U183"><span class="mxinfo " id="T3:U184">-<span class="mxinfo " id="T3:U185">sin(<span class="var type1" id="S4T3U281">alpha</span>)</span></span>*<span class="mxinfo " id="T3:U187">sin(<span class="var type1" id="S5T3U284">beta</span>)</span></span>      <span class="mxinfo " id="T3:U189">cos(<span class="var type1" id="S4T3U287">alpha</span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="57,65" id="srcline65">65</a></span><span class="line">    <span class="mxinfo " id="T6:U191"><span class="mxinfo " id="T3:U192">sin(<span class="var type1" id="S5T3U291">beta</span>)</span>               <span class="mxinfo " id="T3:U194">cos(<span class="var type1" id="S5T3U294">beta</span>)</span>                 <span class="mxinfo " id="T3:U196">0</span></span>       ;</span></span>
<span class="srcline"><span class="lineno"><a href="57,66" id="srcline66">66</a></span><span class="line">    <span class="mxinfo " id="T6:U197"><span class="mxinfo " id="T3:U198"><span class="mxinfo " id="T3:U199">-<span class="mxinfo " id="T3:U200">cos(<span class="var type1" id="S4T3U301">alpha</span>)</span></span>*<span class="mxinfo " id="T3:U202">cos(<span class="var type1" id="S5T3U304">beta</span>)</span></span>   <span class="mxinfo " id="T3:U204"><span class="mxinfo " id="T3:U205">cos(<span class="var type1" id="S4T3U308">alpha</span>)</span>*<span class="mxinfo " id="T3:U207">sin(<span class="var type1" id="S5T3U311">beta</span>)</span></span>     <span class="mxinfo " id="T3:U209">sin(<span class="var type1" id="S4T3U314">alpha</span>)</span></span>   ]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,67" id="srcline67">67</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="57,68" id="srcline68">68</a></span><span class="line"><span class="mxinfo " id="T3:U211"><span class="var type1" id="S42T3U317">sigma_a</span> = <span class="mxinfo " id="T3:U213">(<span class="mxinfo " id="T3:U214"><span class="mxinfo " id="T3:U215"><span class="mxinfo " id="T3:U216">1</span> + <span class="mxinfo " id="T3:U217">exp(<span class="mxinfo " id="T3:U218"><span class="mxinfo " id="T3:U219">-<span class="var type1" id="S25T3U327">BQ_M</span></span>*(<span class="mxinfo " id="T3:U221"><span class="var type1" id="S4T3U330">alpha</span>-<span class="var type1" id="S26T3U331">BQ_alpha0</span></span>)</span>)</span></span> + <span class="mxinfo " id="T3:U224">exp(<span class="mxinfo " id="T3:U225"><span class="var type1" id="S25T3U335">BQ_M</span>*(<span class="mxinfo " id="T3:U227"><span class="var type1" id="S4T3U338">alpha</span>+<span class="var type1" id="S26T3U339">BQ_alpha0</span></span>)</span>)</span></span>)/(<span class="mxinfo " id="T3:U230">( <span class="mxinfo " id="T3:U231"><span class="mxinfo " id="T3:U232">1</span> + <span class="mxinfo " id="T3:U233">exp(<span class="mxinfo " id="T3:U234"><span class="mxinfo " id="T3:U235">-<span class="var type1" id="S25T3U349">BQ_M</span></span>*(<span class="mxinfo " id="T3:U237"><span class="var type1" id="S4T3U352">alpha</span>-<span class="var type1" id="S26T3U353">BQ_alpha0</span></span>)</span>)</span></span>)*(<span class="mxinfo " id="T3:U240"><span class="mxinfo " id="T3:U241">1</span> + <span class="mxinfo " id="T3:U242">exp(<span class="mxinfo " id="T3:U243"><span class="var type1" id="S25T3U360">BQ_M</span>*(<span class="mxinfo " id="T3:U245"><span class="var type1" id="S4T3U363">alpha</span>+<span class="var type1" id="S26T3U364">BQ_alpha0</span></span>)</span>)</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,69" id="srcline69">69</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="57,70" id="srcline70">70</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="57,71" id="srcline71">71</a></span><span class="line"><span class="mxinfo " id="T3:U248"><span class="var type1" id="S44T3U367">CLofalpha</span> = <span class="mxinfo " id="T3:U250"><span class="mxinfo " id="T3:U251">(<span class="mxinfo " id="T3:U252"><span class="mxinfo " id="T3:U253">1</span>-<span class="var type1" id="S42T3U373">sigma_a</span></span>)*(<span class="mxinfo " id="T3:U255"><span class="var type1" id="S17T3U376">BQ_CL0</span>+<span class="mxinfo " id="T3:U257"><span class="var type1" id="S18T3U378">BQ_CL_alpha</span>*<span class="var type1" id="S4T3U379">alpha</span></span></span>)</span> + <span class="mxinfo " id="T3:U260"><span class="var type1" id="S42T3U381">sigma_a</span>*(<span class="mxinfo " id="T3:U262"><span class="mxinfo " id="T3:U263"><span class="mxinfo " id="T3:U264"><span class="mxinfo " id="T3:U265">2</span>*<span class="mxinfo " id="T3:U266">sign(<span class="var type1" id="S4T3U389">alpha</span>)</span></span>*(<span class="mxinfo " id="T3:U268"><span class="mxinfo " id="T3:U269">sin(<span class="var type1" id="S4T3U394">alpha</span>)</span>^2</span>)</span>*<span class="mxinfo " id="T3:U271">cos(<span class="var type1" id="S4T3U398">alpha</span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,72" id="srcline72">72</a></span><span class="line"><span class="comment">%     CLofalpha = (2*sign(alpha)*(sin(alpha)^2)*cos(alpha));</span></span></span>
<span class="srcline"><span class="lineno"><a href="57,73" id="srcline73">73</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="57,74" id="srcline74">74</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="57,75" id="srcline75">75</a></span><span class="line"><span class="mxinfo " id="T3:U273"><span class="var type1" id="S46T3U401">CL</span> = <span class="mxinfo " id="T3:U275"><span class="var type1" id="S44T3U403">CLofalpha</span> + <span class="mxinfo " id="T3:U277"><span class="var type1" id="S19T3U405">BQ_CLq</span>*(<span class="mxinfo " id="T3:U279"><span class="mxinfo " id="T3:U280"><span class="mxinfo " id="T3:U281"><span class="var type1" id="S28T3U410">q</span>*<span class="var type1" id="S13T3U411">BQ_c</span></span>/<span class="mxinfo " id="T3:U284">2</span></span>*<span class="var type1" id="S34T3U413">V</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,76" id="srcline76">76</a></span><span class="line"><span class="mxinfo " id="T3:U286"><span class="var type1" id="S47T3U416">CD</span> = <span class="mxinfo " id="T3:U288"><span class="mxinfo " id="T3:U289"><span class="var type1" id="S16T3U419">BQ_CD_0</span> + <span class="mxinfo " id="T3:U291"><span class="var type1" id="S23T3U421">BQ_k</span>*(<span class="mxinfo " id="T3:U293"><span class="var type1" id="S46T3U424">CL</span>^2</span>)</span></span> + <span class="mxinfo " id="T3:U295"><span class="mxinfo " id="T3:U296">1</span>*(<span class="mxinfo " id="T3:U297">(<span class="mxinfo " id="T3:U298">sin(<span class="var type1" id="S4T3U433">alpha</span>)</span>)^2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,77" id="srcline77">77</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="57,78" id="srcline78">78</a></span><span class="line"><span class="mxinfo " id="T4:U300"><span class="var type1" id="S48T4U437">omega_w</span> = <span class="mxinfo " id="T4:U302"><span class="var type1" id="S36T26U439">Rq2w</span>*<span class="var type1" id="S8T4U440">omega</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,79" id="srcline79">79</a></span><span class="line"><span class="mxinfo " id="T3:U305"><span class="var type1" id="S49T3U443">p_w</span> = <span class="mxinfo " id="T3:U307"><span class="var type1" id="S48T4U445">omega_w</span>(<span class="mxinfo " id="T14:U309">1</span>,<span class="mxinfo " id="T14:U310">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,80" id="srcline80">80</a></span><span class="line"><span class="mxinfo " id="T3:U311"><span class="var type1" id="S50T3U450">q_w</span> = <span class="mxinfo " id="T3:U313"><span class="var type1" id="S48T4U452">omega_w</span>(<span class="mxinfo " id="T3:U315">2</span>,<span class="mxinfo " id="T3:U316">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,81" id="srcline81">81</a></span><span class="line"><span class="mxinfo " id="T3:U317"><span class="var type1" id="S51T3U457">r_w</span> = <span class="mxinfo " id="T3:U319"><span class="var type1" id="S48T4U459">omega_w</span>(<span class="mxinfo " id="T14:U321">3</span>,<span class="mxinfo " id="T14:U322">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,82" id="srcline82">82</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="57,83" id="srcline83">83</a></span><span class="line"><span class="mxinfo " id="T3:U323"><span class="var type1" id="S52T3U464">CY</span> = <span class="mxinfo " id="T3:U325"><span class="mxinfo " id="T3:U326"><span class="mxinfo " id="T3:U327"><span class="var type1" id="S20T3U468">BQ_CY_beta</span>*<span class="var type1" id="S5T3U469">beta</span></span> + <span class="mxinfo " id="T3:U330"><span class="var type1" id="S21T3U471">BQ_CY_p</span>*(<span class="mxinfo " id="T3:U332"><span class="mxinfo " id="T3:U333"><span class="var type1" id="S49T3U475">p_w</span>*<span class="var type1" id="S14T3U476">BQ_b</span></span>/(<span class="mxinfo " id="T3:U336"><span class="mxinfo " id="T3:U337">2</span>*<span class="var type1" id="S34T3U480">V</span></span>)</span>)</span></span> + <span class="mxinfo " id="T3:U339"><span class="var type1" id="S22T3U482">BQ_CY_r</span>*(<span class="mxinfo " id="T3:U341"><span class="mxinfo " id="T3:U342"><span class="var type1" id="S51T3U486">r_w</span>*<span class="var type1" id="S14T3U487">BQ_b</span></span>/(<span class="mxinfo " id="T3:U345"><span class="mxinfo " id="T3:U346">2</span>*<span class="var type1" id="S34T3U491">V</span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,84" id="srcline84">84</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="57,85" id="srcline85">85</a></span><span class="line"><span class="mxinfo " id="T3:U348"><span class="var type1" id="S53T3U494">L</span> = <span class="mxinfo " id="T3:U350"><span class="mxinfo " id="T3:U351"><span class="mxinfo " id="T3:U352"><span class="mxinfo " id="T3:U353"><span class="mxinfo " id="T3:U354">0.5</span>*<span class="var type1" id="S30T3U500">rho</span></span>*(<span class="mxinfo " id="T3:U356"><span class="var type1" id="S34T3U503">V</span>^2</span>)</span>*<span class="var type1" id="S15T3U505">BQ_S</span></span>*<span class="var type1" id="S46T3U506">CL</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="57,86" id="srcline86">86</a></span><span class="line"><span class="mxinfo " id="T3:U360"><span class="var type1" id="S54T3U509">D</span> = <span class="mxinfo " id="T3:U362"><span class="mxinfo " id="T3:U363"><span class="mxinfo " id="T3:U364"><span class="mxinfo " id="T3:U365"><span class="mxinfo " id="T3:U366">0.5</span>*<span class="var type1" id="S30T3U515">rho</span></span>*(<span class="mxinfo " id="T3:U368"><span class="var type1" id="S34T3U518">V</span>^2</span>)</span>*<span class="var type1" id="S15T3U520">BQ_S</span></span>*<span class="var type1" id="S47T3U521">CD</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="57,87" id="srcline87">87</a></span><span class="line"><span class="mxinfo " id="T3:U372"><span class="var type1" id="S55T3U524">Y</span> = <span class="mxinfo " id="T3:U374"><span class="mxinfo " id="T3:U375"><span class="mxinfo " id="T3:U376"><span class="mxinfo " id="T3:U377"><span class="mxinfo " id="T3:U378">0.5</span>*<span class="var type1" id="S30T3U530">rho</span></span>*(<span class="mxinfo " id="T3:U380"><span class="var type1" id="S34T3U533">V</span>^2</span>)</span>*<span class="var type1" id="S15T3U535">BQ_S</span></span>*<span class="var type1" id="S52T3U536">CY</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="57,88" id="srcline88">88</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="57,89" id="srcline89">89</a></span><span class="line"><span class="mxinfo " id="T4:U384"><span class="var type1" id="S2T4U539">Fa</span>=<span class="mxinfo " id="T4:U386"><span class="mxinfo " id="T26:U387"><span class="mxinfo " id="T3:U388">2</span>*<span class="var type1" id="S39T26U543">A</span></span>*<span class="mxinfo " id="T4:U390">[<span class="mxinfo " id="T3:U391">-<span class="var type1" id="S54T3U547">D</span></span>;<span class="var type1" id="S55T3U549">Y</span>;<span class="mxinfo " id="T3:U394">-<span class="var type1" id="S53T3U552">L</span></span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,90" id="srcline90">90</a></span><span class="line"><span class="mxinfo " id="T3:U396"><span class="mxinfo " id="T3:U397"><span class="var type1" id="S2T4U556">Fa</span>(<span class="mxinfo " id="T3:U399">2</span>,<span class="mxinfo " id="T3:U400">1</span>)</span>=<span class="mxinfo " id="T3:U401">-<span class="mxinfo " id="T3:U402"><span class="var type1" id="S2T4U561">Fa</span>(<span class="mxinfo " id="T3:U404">2</span>,<span class="mxinfo " id="T3:U405">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,91" id="srcline91">91</a></span><span class="line"><span class="mxinfo " id="T3:U406"><span class="mxinfo " id="T3:U407"><span class="var type1" id="S2T4U567">Fa</span>(<span class="mxinfo " id="T3:U409">3</span>,<span class="mxinfo " id="T3:U410">1</span>)</span>=<span class="mxinfo " id="T3:U411">-<span class="mxinfo " id="T3:U412"><span class="var type1" id="S2T4U572">Fa</span>(<span class="mxinfo " id="T3:U414">3</span>,<span class="mxinfo " id="T3:U415">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,92" id="srcline92">92</a></span><span class="line"><span class="mxinfo " id="T4:U416"><span class="var type1" id="S3T4U577">Fa_w</span> = <span class="mxinfo " id="T4:U418">[<span class="var type1" id="S53T3U580">L</span>;<span class="var type1" id="S54T3U582">D</span>;<span class="var type1" id="S55T3U584">Y</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="57,93" id="srcline93">93</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="57,94" id="srcline94">94</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="57,95" id="srcline95">95</a></span><span class="line"></span></span>
</pre>
